<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Modern Glass Scientific Calculator</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  :root {
    --bg: rgba(255, 255, 255, 0.15);
    --bg-blur: rgba(255, 255, 255, 0.25);
    --accent: #a8dadc;
    --accent-hover: #8ec9ca;
    --text-primary: #1d3557;
    --text-secondary: #457b9d;
    --shadow-light: rgba(168, 218, 220, 0.4);
    --btn-bg: rgba(255, 255, 255, 0.4);
    --btn-hover: rgba(255, 255, 255, 0.7);
  }

  * {
    box-sizing: border-box;
  }
  body {
    background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
    font-family: 'Poppins', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  .calculator {
    background: var(--bg);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    box-shadow: 0 8px 30px var(--shadow-light);
    width: 360px;
    max-width: 90vw;
    padding: 25px 30px;
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .header {
    text-align: center;
  }
  .header h1 {
    font-weight: 600;
    font-size: 28px;
    margin-bottom: 5px;
    color: var(--text-primary);
  }
  .header p {
    font-weight: 400;
    font-size: 14px;
    color: var(--text-secondary);
    margin-top: 0;
  }

  .display {
    background: var(--bg-blur);
    border-radius: 16px;
    padding: 18px 24px;
    box-shadow: inset 0 0 10px var(--shadow-light);
    font-size: 28px;
    font-weight: 600;
    text-align: right;
    color: var(--text-primary);
    min-height: 60px;
    user-select: none;
    overflow-wrap: break-word;
    word-break: break-all;
  }
  .expression {
    font-weight: 400;
    font-size: 14px;
    color: var(--text-secondary);
    min-height: 18px;
  }

  .buttons {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 14px;
  }

  button {
    background: var(--btn-bg);
    border: none;
    border-radius: 14px;
    font-weight: 600;
    font-size: 16px;
    color: var(--text-primary);
    padding: 14px 0;
    box-shadow: 0 4px 8px var(--shadow-light);
    cursor: pointer;
    transition: background-color 0.25s ease, transform 0.15s ease;
    user-select: none;
  }
  button:hover {
    background: var(--btn-hover);
    transform: scale(1.06);
  }
  button:active {
    transform: scale(0.96);
  }
  button.op {
    color: #ff7f50;
    font-weight: 700;
  }
  button.eq {
    grid-column: span 2;
    background: #ff7f50;
    color: white;
    font-weight: 700;
    box-shadow: 0 6px 15px rgba(255, 127, 80, 0.5);
  }
  button.clear {
    background: #ff6f61;
    color: white;
    font-weight: 700;
    box-shadow: 0 6px 15px rgba(255, 111, 97, 0.5);
  }
  button.fn {
    background: #a8dadc;
    color: #1d3557;
    font-weight: 600;
    box-shadow: 0 4px 10px rgba(168, 218, 220, 0.6);
  }

  .wide {
    grid-column: span 2;
  }

  .footer {
    text-align: center;
    font-size: 13px;
    font-weight: 400;
    color: var(--text-secondary);
    margin-top: 12px;
  }

  /* Responsive */
  @media (max-width: 420px) {
    .calculator {
      width: 100%;
      padding: 20px;
    }
    .buttons {
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    button.eq {
      grid-column: span 1;
    }
    .wide {
      grid-column: span 1;
    }
  }
</style>
</head>
<body>
  <main class="calculator" role="application" aria-label="Scientific calculator">
    <header class="header">
      <h1>Scientific Calculator</h1>
      <p>Designed & Developed by Alina Liaquat</p>
    </header>
    <section class="display" aria-live="polite" aria-atomic="true">
      <div class="expression" id="expression"></div>
      <div id="result">0</div>
    </section>
    <section class="buttons" id="buttons">
      <!-- Row 1 -->
      <button class="fn" data-value="mc">MC</button>
      <button class="fn" data-value="mr">MR</button>
      <button class="fn" data-value="mplus">M+</button>
      <button class="fn" data-value="mminus">M-</button>
      <button class="fn" data-value="(">(</button>
      <button class="fn" data-value=")">)</button>

      <!-- Row 2 -->
      <button class="fn" data-value="sin(">sin</button>
      <button class="fn" data-value="cos(">cos</button>
      <button class="fn" data-value="tan(">tan</button>
      <button class="fn" data-value="asin(">asin</button>
      <button class="fn" data-value="acos(">acos</button>
      <button class="fn" data-value="atan(">atan</button>

      <!-- Row 3 -->
      <button class="fn" data-value="ln(">ln</button>
      <button class="fn" data-value="log(">log</button>
      <button class="fn" data-value="exp(">eˣ</button>
      <button class="fn" data-value="^">^</button>
      <button class="fn" data-value="sqrt(">√</button>
      <button class="fn" data-value="!">n!</button>

      <!-- Row 4 -->
      <button data-value="7">7</button>
      <button data-value="8">8</button>
      <button data-value="9">9</button>
      <button class="op" data-value="/">÷</button>
      <button class="op" data-value="%">%</button>
      <button class="clear" data-value="C">C</button>

      <!-- Row 5 -->
      <button data-value="4">4</button>
      <button data-value="5">5</button>
      <button data-value="6">6</button>
      <button class="op" data-value="*">×</button>
      <button class="op" data-value="**">x²</button>
      <button data-value="del">⌫</button>

      <!-- Row 6 -->
      <button data-value="1">1</button>
      <button data-value="2">2</button>
      <button data-value="3">3</button>
      <button class="op" data-value="-">−</button>
      <button class="op" data-value="pow">xʸ</button>
      <button class="eq" data-value="=">=</button>

      <!-- Row 7 -->
      <button class="wide" data-value="0">0</button>
      <button data-value=".">.</button>
      <button class="op" data-value="+">+</button>
      <button class="fn" data-value="pi">π</button>
      <button class="fn" data-value="e">e</button>
    </section>
    <footer class="footer">Developed by Alina Liaquat</footer>
  </main>

<script>
(() => {
  const expressionEl = document.getElementById('expression');
  const resultEl = document.getElementById('result');
  const buttons = document.getElementById('buttons');

  let expression = '';
  let memory = 0;
  let angleMode = 'DEG'; // or 'RAD'

  function updateMemoryDisplay() {
    // You can extend UI to show memory status if needed
  }

  function updateAngleMode() {
    // Update UI to show current angle mode if needed
  }

  function safeEval(expr) {
    let s = expr;

    s = s.replace(/π/g, 'pi');
    s = s.replace(/×/g, '*').replace(/÷/g, '/');
    s = s.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
    s = s.replace(/\^/g, '**');
    s = s.replace(/\bexp\(([^)]+)\)/g, '(Math.exp($1))');
    s = s.replace(/\bln\(/g, '(Math.log(');
    s = s.replace(/\blog\(/g, '(Math.log10(');
    s = s.replace(/\bsqrt\(/g, '(Math.sqrt(');
    s = s.replace(/\be\b/g, 'Math.E');
    s = s.replace(/\bpi\b/g, 'Math.PI');

    s = s.replace(/\b(sin|cos|tan|asin|acos|atan)\(/g, (m, p1) => {
      return `__TRIG__${p1}(`;
    });

    s = s.replace(/(\d+\.?\d*|\([^)]*\))!/g, (m, p1) => {
      return `fact(${p1})`;
    });

    s = s.replace(/pow\(/g, '(');

    if (/[^0-9+\-*/()., MathEPIa-zA-Z_%\*\!]/.test(s)) {
      throw new Error('Invalid characters in expression');
    }

    s = s.replace(/__TRIG__(sin|cos|tan|asin|acos|atan)\(/g, function (m, p1) {
      return `__${p1.toUpperCase()}__(`;
    });

    s = replaceTrigWrappers(s);

    const finalExpr = s;

    const fn = new Function('Math', 'fact', `with (Math) { return (${finalExpr}); }`);
    return fn(Math, fact);
  }

  function replaceTrigWrappers(s) {
    return s.replace(/__(SIN|COS|TAN|ASIN|ACOS|ATAN)__\(/g, function (m, cap) {
      const start = s.indexOf(m);
      const after = start + m.length + 1;
      let depth = 1;
      let i = after;
      while (i < s.length && depth > 0) {
        if (s[i] === '(') depth++;
        else if (s[i] === ')') depth--;
        i++;
      }
      const inside = s.slice(after, i - 1);
      const wrapped = trigWrap(cap.toLowerCase(), inside);
      return wrapped + s.slice(i);
    }).replace(/__SIN__|__COS__|__TAN__|__ASIN__|__ACOS__|__ATAN__/g, '');

    function trigWrap(name, inside) {
      if (['sin', 'cos', 'tan'].includes(name)) {
        if (angleMode === 'DEG') {
          return `Math.${name}(((${inside}) * Math.PI)/180)`;
        } else {
          return `Math.${name}(${inside})`;
        }
      } else {
        if (['asin', 'acos', 'atan'].includes(name)) {
          if (angleMode === 'DEG') {
            const base = `Math.${name}(${inside})`;
            return `((${base}) * 180 / Math.PI)`;
          } else {
            return `Math.${name}(${inside})`;
          }
        }
      }
    }
  }

  function fact(n) {
    if (typeof n !== 'number' || !isFinite(n)) throw new Error('Invalid input for factorial');
    if (n < 0) throw new Error('Factorial for negative numbers is undefined');
    if (Math.abs(n - Math.round(n)) < 1e-12) {
      n = Math.round(n);
      let res = 1;
      for (let i = 2; i <= n; i++) res *= i;
      return res;
    }
    return gamma(n + 1);
  }

  function gamma(z) {
    const p = [
      676.5203681218851, -1259.1392167224028,
      771.32342877765313, -176.61502916214059,
      12.507343278686905, -0.13857109526572012,
      9.9843695780195716e-6, 1.5056327351493116e-7
    ];
    const g = 7;
    if (z < 0.5) return Math.PI / (Math.sin(Math.PI * z) * gamma(1 - z));
    z -= 1;
    let x = 0.99999999999980993;
    for (let i = 0; i < p.length; i++) x += p[i] / (z + i + 1);
    const t = z + g + 0.5;
    return Math.sqrt(2 * Math.PI) * Math.pow(t, z + 0.5) * Math.exp(-t) * x;
  }

  function tidyNumber(x) {
    if (typeof x !== 'number') return x;
    if (!isFinite(x)) return x;
    const rounded = Math.round(x * 1e12) / 1e12;
    return rounded;
  }

  buttons.addEventListener('click', (e) => {
    const btn = e.target.closest('button');
    if (!btn) return;
    handleInput(btn.dataset.value);
  });

  window.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      e.preventDefault();
      handleInput('=');
      return;
    }
    if (e.key === 'Backspace') {
      e.preventDefault();
      handleInput('del');
      return;
    }
    if (e.key === 'Escape') {
      e.preventDefault();
      handleInput('C');
      return;
    }
    const keyMap = { '/': '/', '*': '*', '-': '-', '+': '+', '%': '%', '.': '.' };
    if (keyMap[e.key]) {
      handleInput(keyMap[e.key]);
      return;
    }
    if (/[0-9]/.test(e.key)) {
      handleInput(e.key);
      return;
    }
  });

  function handleInput(v) {
    try {
      if (v === 'C') {
        expression = '';
        updateExpression();
        updateResult('0');
        return;
      }
      if (v === 'del') {
        expression = expression.slice(0, -1);
        updateExpression();
        return;
      }
      if (v === '=') {
        if (!expression) return;
        const out = safeEval(expression);
        updateResult(Number.isFinite(out) ? tidyNumber(out) : out);
        expression = String(out);
        updateExpression();
        return;
      }
      if (v === 'mc') {
        memory = 0;
        updateMemoryDisplay();
        return;
      }
      if (v === 'mr') {
        expression += String(memory);
        updateExpression();
        return;
      }
      if (v === 'mplus') {
        const val = Number(resultEl.textContent) || 0;
        memory += val;
        updateMemoryDisplay();
        return;
      }
      if (v === 'mminus') {
        const val = Number(resultEl.textContent) || 0;
        memory -= val;
        updateMemoryDisplay();
        return;
      }
      if (v === 'pi') {
        expression += 'pi';
        updateExpression();
        return;
      }
      if (v === 'e') {
        expression += 'e';
        updateExpression();
        return;
      }
      if (v === '**') {
        expression += '**2';
        updateExpression();
        return;
      }
      if (v === '^') {
        expression += '^';
        updateExpression();
        return;
      }
      if (v === 'pow') {
        expression += '^';
        updateExpression();
        return;
      }
      if (/^(sin\(|cos\(|tan\(|asin\(|acos\(|atan\(|ln\(|log\(|exp\(|sqrt\()/i.test(v)) {
        expression += v;
        updateExpression();
        return;
      }

      expression += v;
      updateExpression();
    } catch (err) {
      updateResult('Error');
      console.error(err);
    }
  }

  function updateExpression() {
    expressionEl.textContent = expression;
  }
  function updateResult(v) {
    resultEl.textContent = v;
  }

  updateExpression();
  updateResult('0');
})();
</script>

</body>
</html>
